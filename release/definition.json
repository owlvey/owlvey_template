{
 "tasks": [
	{
		"taskId":"94a74903-f93f-4075-884f-dc11f34058b4",
		"version":"2.*",
		"name":"Azure Create Or Update Resource Group",
		"inputs":{
			"ConnectedServiceName":"PS_CLOUD_PROVIDER_ENDPOINT_ID",
			"action":"Create Or Update Resource Group",
			"resourceGroupName":"$(AZ_RESOURCE_GROUP_NAME)",
			"location":"$(AZ_RESOURCE_GROUP_LOCATION)",
			"templateLocation":"Linked artifact",
			"csmFileLink":"",
			"csmParametersFileLink":"",
			"csmFile":"$(System.DefaultWorkingDirectory)/$(BUILD_DEFINITION)/Scripts/infra.definition.json",
			"csmParametersFile":"$(System.DefaultWorkingDirectory)/$(BUILD_DEFINITION)/Scripts/infra.definition.params.json",
			"overrideParameters":"-skuCapacity 1 -sqlAdministratorLogin \"$(AZ_SQL_ADMIN_LOGIN)\" -sqlAdministratorLoginPassword \"$(AZ_SQL_ADMIN_PASSWORD)\" -location \"$(AZ_RESOURCE_GROUP_LOCATION)\" -environment \"$(ASPNETCORE_ENVIRONMENT)\" -feature \"$(ASPNETCORE_FEATURE)\"",
			"deploymentMode":"Incremental",
			"enableDeploymentPrerequisites":"None",
			"deploymentGroupEndpoint":"",
			"project":"",
			"deploymentGroupName":"",
			"copyAzureVMTags":"true",
			"runAgentServiceAsUser":"false",
			"userName":"",
			"password":"",
			"outputVariable":"",
			"deploymentOutputs":""
		}
	},
	{
		"taskId":"497d490f-eea7-4f2b-ab94-48d9c1acdcb1",
		"version":"3.*",
		"name":"Azure App Service Deploy",
		"inputs":{
			"ConnectedServiceName":"PS_CLOUD_PROVIDER_ENDPOINT_ID",
			"WebAppKind":"app",
			"WebAppName":"$(AZ_APP_SERVICE_NAME)",
			"DeployToSlotFlag":"false",
			"ResourceGroupName":"",
			"SlotName":"",
			"ImageSource":"Registry",
			"AzureContainerRegistry":"",
			"AzureContainerRegistryLoginServer":"",
			"AzureContainerRegistryImage":"",
			"AzureContainerRegistryTag":"",
			"DockerRepositoryAccess":"public",
			"RegistryConnectedServiceName":"",
			"PrivateRegistryImage":"",
			"PrivateRegistryTag":"",
			"DockerNamespace":"",
			"DockerRepository":"",
			"DockerImageTag":"",
			"VirtualApplication":"",
			"Package":"$(System.DefaultWorkingDirectory)/$(BUILD_DEFINITION)/Executable/application.zip",
			"BuiltinLinuxPackage":"$(System.DefaultWorkingDirectory)/**/*.zip",
			"RuntimeStack":"",
			"StartupCommand":"",
			"WebAppUri":"",
			"ScriptType":"",
			"InlineScript":":: You can provide your deployment commands here. One command per line.",
			"ScriptPath":"",
			"GenerateWebConfig":"false",
			"WebConfigParameters":"",
			"AppSettings":"",
			"ConfigurationSettings":"",
			"TakeAppOfflineFlag":"true",
			"UseWebDeploy":"true",
			"SetParametersFile":"",
			"RemoveAdditionalFilesFlag":"false",
			"ExcludeFilesFromAppDataFlag":"false",
			"AdditionalArguments":"",
			"RenameFilesFlag":"false",
			"XmlTransformation":"false",
			"XmlVariableSubstitution":"false",
			"JSONFiles":""
		}
	},
	{
		"taskId":"ce85a08b-a538-4d2b-8589-1d37a9ab970f",
		"version":"1.*",
		"name":"Azure SQL Publish",
		"inputs":{
			"ConnectedServiceNameSelector":"ConnectedServiceNameARM",
			"ConnectedServiceName":"",
			"ConnectedServiceNameARM":"PS_CLOUD_PROVIDER_ENDPOINT_ID",
			"ServerName":"$(AZ_SQL_SERVER_NAME)",
			"DatabaseName":"$(AZ_SQL_DATABASE_NAME)",
			"SqlUsername":"$(AZ_SQL_ADMIN_LOGIN)",
			"SqlPassword":"$(AZ_SQL_ADMIN_PASSWORD)",
			"DeploymentAction":"Publish",
			"TaskNameSelector":"SqlTask",
			"DacpacFile":"",
			"BacpacFile":"",
			"SqlFile":"$(System.DefaultWorkingDirectory)/$(BUILD_DEFINITION)/Scripts/migrations.sql",
			"SqlInline":"",
			"PublishProfile":"",
			"AdditionalArguments":"",
			"SqlAdditionalArguments":"",
			"InlineAdditionalArguments":"",
			"IpDetectionMethod":"AutoDetect",
			"StartIpAddress":"",
			"EndIpAddress":"",
			"DeleteFirewallRule":"true"
		}
	}
  ],
 "variables": 
 {
	"BUILD_DEFINITION":{
		"isSecret":false,
		"value":"PS_COMMIT_STAGE_NAME",
		"scope":{
			"key":2147483647,
			"value":"Release",
			"isDefault":true
		}
	},
	"AZ_RESOURCE_GROUP_NAME":{
		"allowOverride":false,
		"isSecret":false,
		"value":"PS_ORGANIZATION_NAMEPS_PROJECT_NAMEPS_SERVICE_NAME$(ASPNETCORE_ENVIRONMENT)$(ASPNETCORE_FEATURE)",
		"scope":{
			"key":2147483647,
			"value":"Release",
			"isDefault":true
		}
	},
	"AZ_RESOURCE_GROUP_LOCATION":{
		"allowOverride":false,
		"isSecret":false,
		"value":"PS_ACCESS_REGION",
		"scope":{
			"key":2147483647,
			"value":"Release",
			"isDefault":true
		}
	},
	"AZ_SQL_ADMIN_LOGIN":{
		"allowOverride":false,
		"isSecret":false,
		"value":"PS_PROJECT_NAMEPS_SERVICE_NAMEadmin",
		"scope":{
			"key":2147483647,
			"value":"Release",
			"isDefault":true
		}
	},
	"AZ_SQL_ADMIN_PASSWORD":{
		"allowOverride":false,
		"isSecret":false,
		"value":"PS_NEW_PASSWORD",
		"scope":{
			"key":2147483647,
			"value":"Release",
			"isDefault":true
		}
	},
	"AZ_APP_SERVICE_NAME":{
		"allowOverride":false,
		"isSecret":false,
		"value":"PS_ORGANIZATION_NAMEPS_PROJECT_NAMEPS_SERVICE_NAME$(ASPNETCORE_ENVIRONMENT)$(ASPNETCORE_FEATURE)website",
		"scope":{
			"key":2147483647,
			"value":"Release",
			"isDefault":true
		}
	},
	"AZ_SQL_DATABASE_NAME":{
		"allowOverride":false,
		"isSecret":false,
		"value":"PS_SERVICE_NAMEDb",
		"scope":{
			"key":2147483647,
			"value":"Release",
			"isDefault":true
		}
	},
	"AZ_SQL_SERVER_NAME":{
		"allowOverride":false,
		"isSecret":false,
		"value":"PS_ORGANIZATION_NAMEPS_PROJECT_NAMEPS_SERVICE_NAME$(ASPNETCORE_ENVIRONMENT)$(ASPNETCORE_FEATURE)sqlserver.database.windows.net,1433",
		"scope":{
			"key":2147483647,
			"value":"Release",
			"isDefault":true
		}
	}
 }
}